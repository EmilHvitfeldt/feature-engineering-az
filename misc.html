<!-- collapse buttons -->
<script>
  (function () {
    "use strict";

    const container = document.querySelector(".sidebar-title");

    // Collapse button
    const collapseButton = document.createElement("button");
    collapseButton.setAttribute("aria-label", "collapse");
    collapseButton.style.border = "none";
    collapseButton.style.backgroundColor = "unset";

    const iconCollapse = document.createElement("i");
    iconCollapse.classList.add("bi", "bi-arrows-collapse");
    collapseButton.appendChild(iconCollapse);

    collapseButton.addEventListener("click", function () {
      if (iconCollapse.classList.contains("bi-arrows-collapse")) {
        document
          .querySelectorAll("a.sidebar-item-toggle:not(.collapsed)")
          .forEach((x) => x.click());
        iconCollapse.classList.replace("bi-arrows-collapse", "bi-arrows-expand");
      } else {
        document
          .querySelectorAll("a.sidebar-item-toggle.collapsed")
          .forEach((x) => x.click());
        iconCollapse.classList.replace("bi-arrows-expand", "bi-arrows-collapse");
      }
    });

    container.appendChild(collapseButton);

    // Random button
    const randomButton = document.createElement("button");
    randomButton.setAttribute("aria-label", "random");
    randomButton.style.border = "none";
    randomButton.style.backgroundColor = "unset";

    const iconRandom = document.createElement("i");
    iconRandom.classList.add("bi", "bi-dice-6");
    randomButton.appendChild(iconRandom);

    randomButton.addEventListener("click", function () {
      const allLinks = document.querySelectorAll(
        ".sidebar-item-text.sidebar-link"
      );

      // Only keep chapters, excluding WIP
      const chapters = Array.from(allLinks).filter((element) => {
        if (!element.querySelector(".chapter-number")) {
          return false;
        }
        const span = element.querySelector("span.chapter-title");
        return !(span && span.textContent.includes("ğŸ—ï¸"));
      });

      const randomLink = chapters[Math.floor(Math.random() * chapters.length)];
      randomLink.click();
    });

    container.appendChild(randomButton);
  })();
</script>